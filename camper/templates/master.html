{% import "macros.html" as macros with context %}
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>{{title}}</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="">
        <meta name="author" content="">
    
        <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
        <!--[if lt IE 9]>
        <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
    
        <!-- Le styles -->
        <link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,400,600,700,800' rel='stylesheet' type='text/css'>
        <link href='http://fonts.googleapis.com/css?family=Roboto:400,500,700,300' rel='stylesheet' type='text/css'>
        <link href='http://fonts.googleapis.com/css?family=Syncopate:400,700' rel='stylesheet' type='text/css'>
        <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
        <link href='https://api.tiles.mapbox.com/mapbox.js/v2.1.5/mapbox.css' rel='stylesheet' />
        
        <link href="{{url_for("static", filename="css/bootstrap.css")}}" rel="stylesheet">
        <link href="{{url_for("static", filename="css/colorbox.css")}}" rel="stylesheet">
        <link href="{{url_for("uploader.static", filename="css/fileuploader.css")}}" rel="stylesheet">
        <link rel="stylesheet" href="{{url_for("static", filename="js/components/jquery-ui/themes/smoothness/jquery-ui.min.css")}}">

        <style>
            body {
                padding-top: 60px; /* 60px to make the container go all the way to the bottom of the topbar */
            }
        </style>

        {% block css %}
        {# for additional css #}
        {% endblock %}

        <link rel="shortcut icon" href="{{url_for("static", filename="img/favicon.ico")}}" type="image/x-icon">
        <link rel="icon" href="{{url_for("static", filename="img/favicon.ico")}}" type="image/x-icon">
        
        <script src="{{url_for('static', filename='js/components/jquery/dist/jquery.min.js')}}"></script>
        <script src="{{url_for('static', filename='js/components/angular/angular.min.js')}}"></script>

        {% block head %}
        {% endblock %}
    
    </head>

    <body data-i18n-areyousure="{{_("Are you sure?")}}" id="{{body_id|d('')}}" data-lang="{{LANGUAGE}}" id="{{body_id}}" class="{{body_class}}">
        {% block navbar %}
        <nav class="navbar navbar-default navbar-inverse navbar-fixed-top" role="navigation">
            <div class="{{'container' if not container=="full" else "container-fluid"}}">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                      <span class="sr-only">Toggle navigation</span>
                      <span class="icon-bar"></span>
                      <span class="icon-bar"></span>
                      <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="{{url_for("index")}}">Camper</a>
                </div>
                <div id="navbar" class="navbar-collapse collapse">
                    <ul class="nav navbar-nav">
                            <li class="active"><a href="/">{{_('Home')}}</a></li>
                        {% for page in menu_pages %}
                            <li>
                                <a href="{{url_for("page", page_slug=page.slug)}}">{{page.menu_title}}</a>
                            </li>
                        {% endfor %}
                        {% for action in top_actions %}
                            <li class="{{'active' if action.active}}">
                                <a href="{{action.url}}">{{action.name}}</a>
                            </li>
                        {% endfor %}
                        <li><a target="blog" href="http://blog.barcamptools.eu">{{_('Blog')}}</a></li>
                        <li><a target="feedback" href="http://yourpart.eu/p/camper">{{_('Ideas / Feedback')}}</a></li>
                    </ul>
                    <ul class="nav navbar-nav navbar-right"> 
                            <li class="divider-vertical"></li>
                        {% if LANGUAGE=="de" %}
                            <li><a href="{{url_for("index", __l='en', _append=True)}}">english</a></li>
                        {% else %}
                            <li><a href="{{url_for("index", __l='de', _append=True)}}">deutsch</a></li>
                        {% endif %}
                        {% if is_main_admin %}
                            <li><a href="{{url_for("admin_index")}}"><b>{{_('ADMINISTRATION')}}</b></a></li>
                        {% endif %}
                        {% if not logged_in %}
                            <li class="divider-vertical"></li>
                            <li><a href="{{url_for("userbase.login")}}">{{_('Login')}}</a></li>
                            <li><a href="{{url_for("userbase.register")}}">{{_('Register')}}</a></li>
                        {% else %}
                            <li class="dropdown">
                                <a class="dropdown-toggle" href="#" data-toggle="dropdown">{{user.fullname}}<strong class="caret"></strong></a>
                                <ul class="dropdown-menu">
                                    <li><a href="{{url_for('profile', username = user.username)}}">{{_('my profile')}}</a></li>
                                    <li><a href="{{url_for('userbase.pw_set')}}">{{_('Change Password')}}</a></li>
                                    <li><a href="{{url_for('userbase.logout')}}">{{_('Log out')}}</a></li>
                                    {# TBD later
                                    <li class="divider"></li>
                                    <li><a><strong>{{_('my barcamps')}}</strong></a></li>
                                    {% for bc in user_barcamps %}
                                        <li><a href="{{url_for("barcamps.index", slug = bc.slug)}}">{{bc.name}}</a></li>
                                    {% endfor %}
                                    #}
                                </ul>
                            </li>
                        {% endif %}
                    </ul>
                </div>
            </div><!-- container fluid -->
        </nav><!-- navbar -->
        {% endblock %}
        {% block topcontainer %}
        
        {% endblock %}
      
        {% block container %}
        <div class="container" id="content">
            {% block flashes %}
            {% for m in get_flashes(with_categories=True) %}
                <div class="alert alert-{{m[0]}}">
                <strong>{{m[1]}}</strong><br>
                </div>
            {% endfor %}
            {% endblock %}

            {% block content %}
            {% block main_content %}

            {% endblock %}
            {% endblock %}
        </div> <!-- /container -->

        {% block footer %}
        <footer>
            <div class="container">
                <a href="/impressum.html">Impressum</a>
            </div>
        </footer>
        {% endblock %}

        {% endblock %} 

        <!-- Le javascript
        ================================================== -->
        <!-- Placed at the end of the document so the pages load faster -->
        <script src="{{url_for('static', filename='js/components/jquery-ui/jquery-ui.js')}}"></script>
        <script src="{{url_for('static', filename='js/components/bootstrap/dist/js/bootstrap.min.js')}}"></script>
        <script src="{{url_for('static', filename='js/components.js')}}"></script>

        {% if locale == "de" %}
            <script src="{{url_for('static', filename='js/components/bootstrap-datepicker/js/locales/bootstrap-datepicker.de.js')}}"></script>
            <script src="{{url_for('static', filename='js/components/angular-i18n/angular-locale_de-de.js')}}"></script>
            <script src="{{url_for('static', filename='js/components/parsleyjs/src/i18n/de.js')}}"></script>
        {% elif locale == "en" %}
            <script src="{{url_for('static', filename='js/components/bootstrap-datepicker/js/locales/bootstrap-datepicker.en.js')}}"></script>
            <script src="{{url_for('static', filename='js/components/parsleyjs/src/i18n/en.js')}}"></script>
        {% endif %}

        <script src="{{url_for("static", filename="js/jquery.validate.min.js")}}"></script>
        {#
            <script src="{{url_for('static', filename='js/components/underscore/underscore-min.js')}}"></script>
            <script src="{{url_for('static', filename='js/components/jquery-colorbox/jquery.colorbox.js')}}"></script>
            
            <script src="{{url_for("static", filename="js/jquery.metadata.min.js")}}"></script>
            <script src="{{url_for("static", filename="js/jquery.form.js")}}"></script>
            <script src="{{url_for("static", filename="js/components/jquery-ui/jquery-ui.min.js")}}"></script>
            {% if LANGUAGE != "en" %}
                <script src="{{url_for("static", filename="js/messages_"+LANGUAGE+".js")}}"></script>
                <script src="{{url_for("static", filename="js/jquery.ui.datepicker-"+LANGUAGE+".js")}}"></script>
            {% else %}
                <script src="{{url_for("static", filename="js/jquery.ui.datepicker-en.js")}}"></script>
            {% endif %}
        #}

        <script src='https://api.tiles.mapbox.com/mapbox.js/v2.1.5/mapbox.js'></script>
        
        <script>
            $(document).ready( function () {
                $('.popinfo').popover();
                $('.ttip').tooltip();
                $(".btn-toggle").click( function () {
                    $(this).button("toggle");
                    var f = $(this).attr("for");
                    if ($(this).hasClass("active")) {
                        $(this).find(".icon").addClass("icon-ok");
                        $("#"+f).attr("value", "1");
                    } else {
                        $(this).find(".icon").removeClass("icon-ok");
                        $("#"+f).attr("value", "0");
                    }
                    var form = $(this).parents("form.live");
                    $(this).parents("form.live").submit();
                    return false;
                });
            });
        </script>
            {% block js %}
            {% endblock %}
            {% block js2 %}
            {% endblock %}

        <script src="{{url_for("static", filename="js/holder.js")}}"></script>
        <script src="{{url_for("static", filename="js/forms.js")}}"></script>
        <script src="{{url_for("uploader.static", filename="js/fileuploader.js")}}"></script>
                
        <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
        <script>
            $(document).ready(function() {
                $(".confirm").click( function() {
                    return confirm($("body").data("i18n-areyousure"));
                });
                $('[data-toggle="tooltip"]').tooltip()
            });
        </script>
    </body>
</html>
