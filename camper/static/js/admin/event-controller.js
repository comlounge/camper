// Generated by CoffeeScript 1.8.0
$(document).ready(function() {
  $("#show-add-form").click(function() {
    $("#add-form-view").show();
    $("#show-add-form").hide();
    return $('[data-toggle="tooltip"]').tooltip();
  });
  $("#cancel-add-form").click(function() {
    $("#add-form-view").hide();
    $("#show-add-form").show();
    return false;
  });
  $("#start_time").timepicker({
    timeFormat: "G:i"
  });
  $("#end_time").timepicker({
    timeFormat: "G:i"
  });
  $('#date').datepicker({
    format: 'd.m.yyyy',
    autoclose: true,
    language: $("body").data("lang")
  });
  $("#own_location").change(function() {
    if (this.checked) {
      return $("#location-view").show();
    } else {
      return $("#location-view").hide();
    }
  });
  $(".delete-event").click(function(e) {
    var d, msg, url;
    e.preventDefault();
    msg = $('body').data("i18n-areyousure");
    if (confirm(msg)) {
      d = $(this).data("event");
      url = $(this).data("url");
      $.ajax({
        url: url,
        type: "POST",
        data: {
          method: "delete",
          event: d
        },
        success: function() {
          return window.location.reload();
        }
      });
    }
    return false;
  });
  if ($('#own_location').is(":checked")) {
    $("#location-view").show();
  }
  $("#bigmap").bigmap();
  $("#lookup-button").click(function() {
    var city, country, street, zip;
    street = $('#location_street').val();
    zip = $('#location_zip').val();
    city = $('#location_city').val();
    country = $('#location_country').val();
    $("#location-picker").modal("show");
    $("#bigmap").bigmap("lookup", street, zip, city, country);
    return false;
  });
  $("#show-on-map").click(function() {
    var city, country, lat, lng, street, zip;
    street = $('#location_street').val();
    zip = $('#location_zip').val();
    city = $('#location_city').val();
    country = $('#location_country').val();
    if (street === "") {
      $('#error-street').popover("show");
      return;
    }
    if (city === "") {
      $('#error-street').popover("show");
      return;
    }
    $("#location-picker").modal("show");
    if ($("#location_lat").val()) {
      lat = $("#location_lat").val();
      lng = $("#location_lng").val();
      $("#bigmap").bigmap("set_coords", lat, lng);
      $("#bigmap").bigmap("place");
    } else {
      $("#bigmap").bigmap("lookup", street, zip, city, country);
    }
    return false;
  });
  $("#location-error-confirm").click(function() {
    $("#location-error-box").hide();
    return $("#location-picker").modal("hide");
  });
  return $("#save-location-button").click(function() {
    $("#location_lat").val($("#tmp_lat").val());
    $("#location_lng").val($("#tmp_lng").val());
    $("#own_coords").val("yes");
    return $("#location-picker").modal("hide");
  });
});
