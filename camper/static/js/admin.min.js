(function(){$(document).ready(function(){return $(".delete-entry").click(function(){var a,b;return a=$(this).data("entry"),b=$(this).data("url"),$.ajax({url:b,type:"POST",data:{method:"delete",entry:a},success:function(){return window.location.reload()}}),!1})})}).call(this),function(){$(document).ready(function(){return $("#show-add-form").click(function(){return $("#add-form-view").show(),$("#show-add-form").hide(),$('[data-toggle="tooltip"]').tooltip()}),$("#cancel-add-form").click(function(){return $("#add-form-view").hide(),$("#show-add-form").show(),!1}),$("#start_time").timepicker({timeFormat:"G:i"}),$("#end_time").timepicker({timeFormat:"G:i"}),$("#date").datepicker({format:"d.m.yyyy",autoclose:!0,language:$("body").data("lang")}),$("#own_location").change(function(){return this.checked?$("#location-view").show():$("#location-view").hide()}),$(".delete-event").click(function(a){var b,c,d;return a.preventDefault(),c=$("body").data("i18n-areyousure"),confirm(c)&&(b=$(this).data("event"),d=$(this).data("url"),$.ajax({url:d,type:"POST",data:{method:"delete",event:b},success:function(){return window.location.reload()}})),!1}),$("#own_location").is(":checked")&&$("#location-view").show(),$("#bigmap").bigmap(),$("#lookup-button").click(function(){var a,b,c,d;return c=$("#location_street").val(),d=$("#location_zip").val(),a=$("#location_city").val(),b=$("#location_country").val(),$("#location-picker").modal("show"),$("#bigmap").bigmap("lookup",c,d,a,b),!1}),$("#show-on-map").click(function(){var a,b,c,d,e,f;return e=$("#location_street").val(),f=$("#location_zip").val(),a=$("#location_city").val(),b=$("#location_country").val(),""===e?void $("#error-street").popover("show"):""===a?void $("#error-street").popover("show"):($("#location-picker").modal("show"),$("#location_lat").val()?(c=$("#location_lat").val(),d=$("#location_lng").val(),$("#bigmap").bigmap("set_coords",c,d),$("#bigmap").bigmap("place")):$("#bigmap").bigmap("lookup",e,f,a,b),!1)}),$("#location-error-confirm").click(function(){return $("#location-error-box").hide(),$("#location-picker").modal("hide")}),$("#save-location-button").click(function(){return $("#location_lat").val($("#tmp_lat").val()),$("#location_lng").val($("#tmp_lng").val()),$("#own_coords").val("yes"),$("#location-picker").modal("hide")})})}.call(this),function(){var a,b;$.fn.serializeObject=function(){var a,b;return b={},a=this.serializeArray(),$.each(a,function(){return void 0!==b[this.name]?(b[this.name].push||(b[this.name]=[b[this.name]]),b[this.name].push(this.value||"")):b[this.name]=this.value||""}),b},a=function(){function a(a,b){return this.elem=a,this.options=b,this.state="view",this.url=$(this.elem).closest("form").attr("action"),this}return a.prototype.clicked=function(){return this.state="view"===this.state?"edit":"view","edit"===this.state?this.show_edit_field():void 0},a.prototype.show_edit_field=function(){var a;return a=$(this.elem).data("field"),$.ajax({url:this.url,type:"GET",data:{field:a},success:function(a){return function(b){return a.payload=$(a.elem).html(),$(a.elem).html(b.html),a.escape()}}(this)})},a.prototype.close_edit_field=function(){return this.state="view",$(this.elem).html(this.payload),this.escape()},a.prototype.escape=function(){return"view"===this.state?$(document).off("keyup.editable.keys"):($(document).on("keyup.editable.keys",function(a){return function(b){return 27===b.which&&a.close_edit_field(),13===b.which&&console.log("enter"),b.preventDefault()}}(this)),$(this.elem).closest("form").submit(function(a){return a.preventDefault(),!1}))},a}(),$.fn.editable=function(b){var c;return null==b&&(b={}),c=function(b){var c,d,e;return c=$(this),d=$(this).data("editable"),e="object"==typeof b&&b,d||(d=new a(this,e),c.data("editable",d)),d.clicked()},$(this).each(c),this},$.fn.limitchars=function(a){var b;return null==a&&(a={}),b=function(){var a,b;return a=$(this),b="1234567890abcdefghijklmnopqrstuvwxyz-_",$(this).keypress(function(a){var c;return c=parseInt(a.which),13!==c&&8!==c&&0!==c&&a.ctrlKey===!1&&a.altKey===!1?-1!==b.indexOf(String.fromCharCode(c)):!0})},$(this).each(b),this},$.fn.publish_date=function(a){var b,c,d,e,f;return null==a&&(a={}),f=null,c=function(){var a,c;return f=this,a=$(f).find(".date").datepicker("getDate"),a=$(f).find(".time").timepicker("getTime",[a]),c=new Date,a>=c?e():b(),$(f).find(".edit-published").click(function(){return e()}),$(f).find(".set-now").click(function(){return d(),b()})},d=function(){var a;return a=new Date,$(f).find(".date").datepicker("setDate",[a]),$(f).find(".time").timepicker("setTime",a)},e=function(){return $(f).find(".immediate-button").hide(),$(f).find(".date-edit").show(),$(f).find(".immediate").val("False")},b=function(){return $(f).find(".date-edit").hide(),$(f).find(".immediate-button").show(),$(f).find(".immediate").val("True")},$(this).each(c),this},$.fn.view_edit_group=function(a){var b,c;return null==a&&(a={}),c=null,b=function(){return c=this,$(c).find(".input-switch").click(function(){return $(c).find(".input-controls").show(),$(c).find(".input-view").hide()}),$(c).find(".cancel-switch").click(function(){return $(c).find(".input-controls").hide(),$(c).find(".input-view").show()}),$(c).find(".submit").click(function(){var a,b;return b=$(c).data("url"),a=$(c).find("form").serializeObject(),$.ajax({url:b,type:"POST",data:a,success:function(){return function(a){return $(".workflow-"+a.new_state).attr("selected","selected"),$(".workflow-state").text(a.new_text_state),$(c).find(".input-controls").hide(),$(c).find(".input-view").show(),"published"===a.new_state?$("#publish-button").hide():$("#publish-button").show()}}(this)})})},$(this).each(b),this},b=function(a){var c,d,e;return c=function(b,c){var d;return this.options=c,this.$body=a(document.body),this.$element=a(b),this.map=null,this.marker=null,L.Icon.Default.imagePath="/static/img",L.mapbox.accessToken=this.options.accesstoken,console.log("init"),c={zoom:14},this.map=L.mapbox.map(this.$element.attr("id"),this.options.mapid,c),this.lat=null,this.lng=null,d=this.map,a("#location-picker").on("shown.bs.modal",function(){return a(".action-overlay").show(),a("#location-error").hide(),a(".spinner-overlay").hide(),d.invalidateSize(),a("#save-location-button").prop("disabled",!0)}),this},c.DEFAULTS={location_url:"",lat:null,lng:null,accesstoken:"",admin:0,mapid:"",locationurl:"",orig_lat:null,orig_lng:null,wobble:!1},c.prototype.set_coords=function(b,c){return this.lat=b,this.lng=c,a("#save-location-button").prop("disabled",!1)},c.prototype.place=function(){var b,c,d;return d=this,this.marker&&this.map.removeLayer(this.marker),this.map.setView([this.lat,this.lng]),c={},1===this.options.admin&&(c={draggable:!0}),this.marker=L.marker([this.lat,this.lng],c).addTo(this.map),b=function(){var b;return b=d.marker.getLatLng(),d.lat=b.lat,d.lng=b.lng,a("#tmp_lat").val(b.lat),a("#tmp_lng").val(b.lng)},this.marker.on("dragend",b)},c.prototype.random=function(){var a,b,c,d;return c=(Math.random()-.5)/100,d=(Math.random()-.5)/100,a=this.map.getCenter(),a.lat=a.lat+c,a.lng=a.lng+d,this.map.panTo(a),b=this,this.wobble?setTimeout(function(){return b.random()},300):void 0},c.prototype.lookup=function(c,d,e,f,g){return a("#location-loader").show(),a("#action-overlay").hide(),a(".spinner-overlay").show(),a("#location-error-box").hide(),a(".loader").show(),this.wobble=!0,this.random(),b=this,a.ajax({url:this.options.locationurl,type:"GET",data:a.param({city:e,zip:d,street:c,country:f}),success:function(c){return a(".loader").hide(),b.wobble=!1,c.success?(a(".action-overlay").show(),a("#location-error").hide(),a(".spinner-overlay").hide(),a("#save-location-button").prop("disabled",!1),b.lat=c.lat,b.lng=c.lng,b.orig_lat=c.lat,b.orig_lng=c.lng,b.place(),g?g(c):void 0):(a("#location-error-box").show(),void a("#location-error").text(c.msg).show())},error:function(){return a("#location-error-box").show(),a("#location-error").text("an unknown error occurred, please try again").show(),a("#location-error").show(),a(".action-overlay").hide(),a(".loader").hide(),b.wobble=!1}})},d=function(d){var e;return e=arguments,this.each(function(){var f,g,h;return f=a(this),g=f.data("bc.bigmap"),h=a.extend({},c.DEFAULTS,f.data(),"object"==typeof d&&d),g||(b=new c(this,h),f.data("bc.bigmap",b)),"string"==typeof d?(e=a.map(e,function(a){return[a]}),g[d].apply(g,e.slice(1))):void 0})},e=a.fn.bigmap,a.fn.bigmap=d,a.fn.bigmap.Constructor=c,a.fn.modal.noConflict=function(){return a.fn.bigmap=e,this}},b(jQuery),$(function(){return console.log("ok"),$(".delete-tc").click(function(a){var b,c;return a.preventDefault(),b=$("body").data("i18n-areyousure"),confirm(b)&&(c=$(this).data("url"),$.ajax({url:c,type:"POST",data:{method:"delete"},success:function(){return window.location.reload()}})),!1}),$(".colorpicker-container").colorpicker(),$(".urlscheme").limitchars(),$(".action-confirm").click(function(){var a;return a=$(this).data("confirm"),confirm(a)?!0:!1}),$("body").on("click.editable",'[data-toggle="editable"]',function(a){return $(a.target).editable()}),$(".datetime-widget .time").timepicker({timeFormat:"G:i",show24:!0}),$(".datetime-widget .date").datepicker({format:"d.m.yyyy",autoclose:!0,language:$("body").data("lang")}),$(".datetime-widget").publish_date(),$(".view-edit-group").view_edit_group(),$(".change-state").click(function(){var a,b;return b=$(this).data("url"),a=$(this).data("state"),$.ajax({url:this.url,type:"POST",data:{state:a,field:field},success:function(a){return function(b){return a.payload=$(a.elem).html(),$(a.elem).html(b.html),a.escape()}}(this)})}),tinyMCE.baseURL="/static/js/tinymce/",tinymce.init({selector:".wysiwyg",menubar:!1,convert_urls:!0,relative_urls:!1,remove_script_host:!1,plugins:["image","link","code"],toolbar:"undo redo | formatselect | bold italic | bullist numlist | blockquote | removeformat | image link | code",content_css:"/static/css/tinymce.css"}),$("#bigmap").bigmap(),$("#show-on-map").click(function(){var a,b,c,d,e,f;return e=$("#location_street").val(),f=$("#location_zip").val(),a=$("#location_city").val(),b=$("#location_country").val(),""===e?void $("#error-street").popover("show"):""===a?void $("#error-city").popover("show"):($("#location-picker").modal("show"),$("#location_lat").val()?(c=$("#location_lat").val(),d=$("#location_lng").val(),$("#bigmap").bigmap("set_coords",c,d),$("#bigmap").bigmap("place")):$("#bigmap").bigmap("lookup",e,f,a,b),!1)}),$("#lookup-button").click(function(){var a,b,c,d;return c=$("#location_street").val(),d=$("#location_zip").val(),a=$("#location_city").val(),b=$("#location_country").val(),$("#location-picker").modal("show"),$("#bigmap").bigmap("lookup",c,d,a,b),!1}),$("#location-error-confirm").click(function(){return $("#location-error-box").hide(),$("#location-picker").modal("hide")}),$("#save-location-button").click(function(){return $("#location_lat").val($("#tmp_lat").val()),$("#location_lng").val($("#tmp_lng").val()),$("#own_coords").val("yes"),$("#location-picker").modal("hide")}),$(".datepicker").datepicker({format:"d.m.yyyy",autoclose:!0,language:$("body").data("lang")}),$(".parsley-validate").length&&$(".parsley-validate").parsley({excluded:"input[type=file]",errorsWrapper:"<span class='errors-block help-block'></span>",errorsContainer:function(a){return console.log(a),a.$element.closest("div")}}).addAsyncValidator("bcslug",function(a){return a.responseJSON?a.responseJSON.validated:!1},CONFIG.slug_validation_url).addAsyncValidator("pageslug",function(a){return a.responseJSON?a.responseJSON.validated:!1},CONFIG.page_slug_validation_url),$("#bcform #slug").slugify("#name",{separator:"",whitespace:""}),$("#pageform #slug").slugify("#title",{separator:"",whitespace:"-"}),$(".listing").on("click",".confirmdelete",function(){var a,b;return a=$(this).data("entry"),b=$(this).data("url"),$.ajax({url:b,type:"POST",data:{method:"delete",entry:a},success:function(a){return a.reload?window.location.reload():a.url?window.location=b:a.id?($("#"+a.id).css({"background-color":"#eaa"}),$("#"+a.id).slideUp()):void 0}}),!1})})}.call(this),function(){$(function(){return $("#imagelisting").on("click",".imagedetailblock .edittoggle",function(){var a;return $(this).closest(".imagedetails").hide(),a=$(this).data("image-id"),$("#imageform-"+a).show()}),$("#imagelisting").on("click",".imagedetailblock .canceltoggle",function(){var a;return $(this).closest(".imagedetailform").hide(),a=$(this).data("image-id"),$("#details-"+a).show()}),$("#imagelisting").on("submit",".imagedetailform",function(){var a,b;return event.preventDefault(),a=$(this).data("image-id"),b=$(this).attr("action"),$.ajax({type:"post",url:b,data:$(this).serialize(),contentType:"application/x-www-form-urlencoded",success:function(b){return $("#block-"+a).replaceWith($(b.html)),$("#imageform-"+a).hide(),$("#details-"+a).show()},error:function(){return alert("an error occurred, please try again later")}})}),$(".listing").on("click",".deletebtn",function(){var a,b,c;return a=$(this).data("image-id"),c=$(this).data("url"),b=$("body").data("i18n-areyousure"),confirm(b)&&$.ajax({url:c,type:"POST",data:{method:"delete",entry:a},success:function(a){return a.id?($("#"+a.id).css({"background-color":"#eaa"}),$("#"+a.id).slideUp()):void 0}}),!1}),$("#edittitle").click(function(){return $("#titleform").show(),$("#titleview").hide(),!1}),$("#canceltitle").click(function(){return $("#titleform").hide(),$("#titleview").show(),!1}),$("#titleform").submit(function(){var a;return event.preventDefault(),a=$(this).attr("action"),$.ajax({type:"post",url:a,data:$(this).serialize(),contentType:"application/x-www-form-urlencoded",success:function(a){return $("#gallerytitle").val(a.title),$("#titleview span").text(a.title),$("#titleform").hide(),$("#titleview").show()},error:function(){return alert("an error occurred, please try again later")}})})})}.call(this),function(){var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(){this.update=b(this.update,this),this.init=b(this.init,this),this.canvas=$("#logocanvas")[0],this.final_canvas=$("#finalcanvas")[0],this.export_canvas=$("#exportcanvas")[0],this.tmp_text=$("#tmp_text"),this.icon_svg=$("#icon-svg"),this.icon_img=null,this.textinput1=$("#logoinput1"),this.textinput2=$("#logoinput2"),this.colorinput_logo=$("#colorinput_logo"),this.colorinput1=$("#colorinput1"),this.colorinput2=$("#colorinput2"),$("#logo_color_logo").val()&&this.colorinput_logo.val($("#logo_color_logo").val()),$("#logo_color1").val()&&this.colorinput1.val($("#logo_color1").val()),$("#logo_color2").val()&&this.colorinput2.val($("#logo_color2").val()),$("#logo_text1").val()&&this.textinput1.val($("#logo_text1").val()),$("#logo_text2").val()&&this.textinput2.val($("#logo_text2").val()),this.text1=this.textinput1.val(),this.text2=this.textinput2.val(),this.color_logo=this.colorinput_logo.val(),this.color1=this.colorinput1.val(),this.color2=this.colorinput2.val()}return a.prototype.font_weight=180,a.prototype.font_family="Open Sans",a.prototype.icon_factor=2.7,a.prototype.icon_label_scale=2,a.prototype.init=function(){return this.init_ui(),this.init_icon(),this.update()},a.prototype.init_icon=function(){},a.prototype.init_ui=function(){return $(".colorpicker-container-logo").colorpicker().on("changeColor",function(a){return function(){return a.color_logo=a.colorinput_logo.val(),a.color1=a.colorinput1.val(),a.color2=a.colorinput2.val(),a.update()}}(this)),$(".logoinput").on("keyup",function(a){return function(){return a.text1=a.textinput1.val(),a.text2=a.textinput2.val(),a.update()}}(this)),$("#save-as-logo-button").click(function(a){return function(b){var c;return b.preventDefault(),$("#logo_color_logo").val(a.colorinput_logo.val()),$("#logo_color1").val(a.colorinput1.val()),$("#logo_color2").val(a.colorinput2.val()),$("#logo_text1").val(a.textinput1.val()),$("#logo_text2").val(a.textinput2.val()),c=function(b){var c,d,e;return d=b.toDataURL("image/png"),e=d.split(","),c=e[e.length-1],$("#save-as-logo-button").hide(),$("#saving-as-logo-button").show(),$.ajax({url:$("#logoeditor-modal").data("upload-url"),type:"POST",data:{data:c,filename:""+a.text1+a.text2+"logo.png"},success:function(a){var b;return b=$("#uploadwidget-logo"),$("#logo").val(a.asset_id),b.find(".uploader-buttons").show(),b.find(".preview-area img").attr("src",a.url),b.find(".progress").hide(),b.find(".preview-area").show(),$("#logoeditor-modal").modal("hide"),$("#save-as-logo-button").show(),$("#saving-as-logo-button").hide()},error:function(){return $("#save-as-logo-button").show(),$("#saving-as-logo-button").hide()}})},a.draw_logo(a.final_canvas,1.5,c)}}(this)),$("#save-as-png-button").click(function(a){return function(b){var c;return b.preventDefault(),c=function(b){var c;c=document.createElement("a"),c.download=""+a.text1+a.text2+"logo.png",c.href=b.toDataURL("image/png"),c.click()},a.draw_logo(a.export_canvas,3.8,c),$("#logoeditor-modal").modal("hide")}}(this))},a.prototype.update=function(){return this.draw_logo(this.canvas,1.1)},a.prototype.draw_logo=function(a,b,c){var d,e,f,g,h;return null==b&&(b=1),null==c&&(c=null),d=a.getContext("2d"),f=this.compute_scale(a,b),g=f.scale,h=f.text_width1,e=f.icon_width,console.log("drawing with scale "+f.scale),d.clearRect(0,0,a.width,a.height),this.draw_text(a,g,e,e+h),this.draw_icon(a,g,c)},a.prototype.compute_scale=function(a,b){var c,d,e,f,g,h,i,j;return d="bold "+.7*this.font_weight+"px "+this.font_family,e="normal "+.7*this.font_weight+"px "+this.font_family,i=$("#tmp_text").css("font",d).text(this.text1).width(),j=$("#tmp_text").css("font",e).text(this.text2).width(),g=90*this.icon_factor,f=1.1*(g+i+j),c=this.canvas.width/f,h=Math.min(1,.98*c),{scale:h*b,icon_width:g*h*b,text_width1:i*h*b,text_width2:j*h*b}},a.prototype.draw_text=function(a,b,c,d){var e,f,g;return e=a.getContext("2d"),e.clearRect(c,0,a.width-c,a.height),f="bold "+this.font_weight*b*.7+"px "+this.font_family,g="normal "+this.font_weight*b*.7+"px "+this.font_family,e.font=f,e.fillStyle=this.color1,e.fillText(this.text1,c,a.height/2+40*b),e.fillStyle=this.color2,e.font=g,e.fillText(this.text2,d,a.height/2+40*b)},a.prototype.draw_icon=function(a,b,c){var d,e,f,g;return null==c&&(c=null),e=a.getContext("2d"),g=this.icon_factor*b,d=this.icon_svg.find("g#container"),d.attr("transform","scale("+g+")"),$(d.children()[0]).css("fill",this.color_logo),f=new Image(90*this.icon_factor*b,90*this.icon_factor*b),f.src="data:image/svg+xml;base64,"+window.btoa($(this.icon_svg).prop("outerHTML")),f.onload=function(d){return function(){var g;return g=a.height/2-b*d.icon_factor*45,e.drawImage(f,0,g),c?c(a):void 0}}(this)},a.prototype.resize=function(){return this.draw_logo(this.canvas)},a}(),$(function(){var b;return $("#logocanvas").length?(b=new a,b.init()):void 0})}.call(this),function(){var a,b,c,d=function(a,b){return function(){return a.apply(b,arguments)}};Array.prototype.toDict=function(a){return this.reduce(function(b,c){return null!=c[a]&&(b[c[a]]=c),b},{})},c=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)},a=function(){return c()+c()+"-"+c()+"-"+c()+"-"+c()+"-"+c()+c()+c()},$.fn.serializeObject=function(){var a,b;return b={},a=this.serializeArray(),$.each(a,function(){return void 0!==b[this.name]?(b[this.name].push||(b[this.name]=[b[this.name]]),b[this.name].push(this.value||"")):b[this.name]=this.value||""}),b},b=function(){var a;return a=$("body").data("lang"),$.ajax({url:"/static/js/camper-"+a+".json",type:"GET",dataType:"json",success:function(a){var b,c,d;return b=new Jed(a),d=function(a,c){return b.translate(a).fetch(c)},c=function(a,c,d,e){return b.translate(a).ifPlural(d,c).fetch(e)},Handlebars.registerHelper("trans",function(a){var b;return b=a.fn(this),d(b,a.hash)}),Handlebars.registerHelper("_",function(a,b){var c;return c=a,d(c,b.hash)}),Handlebars.registerHelper("ntrans",function(a,b){var d,e;return d=b.fn(this),e=b.inverse(this),c(d,e,a,b.hash)}),Handlebars.registerHelper("n_",function(a,b,d,e){return c(b,d,a,e.hash)}),$("#newsessions").sessionboard()},error:function(){return alert("Could not load translations, please try again later")}})},function(b){var c,e,f;return f="sessionboard",e={foo:"bar"},c=function(){function c(a,c){this.element=a,this.del_session=d(this.del_session,this),this.update_session=d(this.update_session,this),this.add_session_modal=d(this.add_session_modal,this),this.del_timeslot=d(this.del_timeslot,this),this.add_timeslot=d(this.add_timeslot,this),this.add_timeslot_modal=d(this.add_timeslot_modal,this),this.edit_room=d(this.edit_room,this),this.edit_room_modal=d(this.edit_room_modal,this),this.del_room=d(this.del_room,this),this.add_room=d(this.add_room,this),this.add_room_modal=d(this.add_room_modal,this),this.delete_all_sessions=d(this.delete_all_sessions,this),this.data={},this.options=b.extend({},e,c),this._defaults=e,this._name=f,this.init()}return c.prototype.init=function(){return this.loadState(),b("#delete-all-sessions").click(function(a){return function(){return a.delete_all_sessions()}}(this))},c.prototype.update=function(){return this.saveState(),this.render()},c.prototype.loadState=function(){return b.ajax({url:"sessionboard/data",dataType:"json",cache:!1,success:function(a){return function(b){return a.data=b,a.render()}}(this),error:function(){return function(a,b,c){return console.error("url",b,c.toString())}}(this)})},c.prototype.saveState=function(){var a;return a={rooms:this.data.rooms,timeslots:this.data.timeslots,sessions:this.data.sessions},b.ajax({url:"sessionboard/data",data:JSON.stringify(this.data),contentType:"application/json",type:"POST",success:function(){return function(){}}(this),error:function(a){return function(){return alert("an error occurred saving the data"),a.loadState()}}(this)})},c.prototype.get_session_id=function(a,b){return b.id+"@"+a.time},c.prototype.generate_sessiontable=function(){var a,b,c,d,e,f,g,h,i,j,k;for(e=[],j=this.data.timeslots,f=0,h=j.length;h>f;f++){for(d=j[f],b={time:d.time,blocked:d.blocked,block_reason:d.reason,slots:[]},k=this.data.rooms,g=0,i=k.length;i>g;g++)a=k[g],c=this.get_session_id(d,a),b.slots.push(this.data.sessions[c]?this.data.sessions[c]:{_id:c});e.push(b)}return e},c.prototype.render=function(){var a;return a=JST.sessiontest({data:this.data,sessions:this.generate_sessiontable(),colwidth:90/(this.data.rooms.length+1)}),b("#newsessions").html(a),this.init_handlers()},c.prototype.delete_all_sessions=function(){return this.data.sessions={},this.update()},c.prototype.add_room_modal=function(){var a;return a=JST["room-modal"]({add_room:!0}),b("#modals").html(a),b("#add-room-modal").modal("show"),b("#room-form-name").focus(),b("#add-room-form").submit(this.add_room),!1},c.prototype.add_room=function(c){var d;return c.preventDefault(),d=b("#add-room-form").serializeObject(),d.id=a(),this.data.rooms.push(d),this.update(),b("#add-room-modal").modal("hide"),!1},c.prototype.del_room=function(a){var c;return confirm(b("body").data("i18n-areyousure"))?(c=b(a.currentTarget).data("index"),this.data.rooms.splice(c,1),this.update()):void 0},c.prototype.edit_room_modal=function(a){var c,d,e;return d=b(a.currentTarget).data("index"),e=this.data.rooms[d],c=JST["room-modal"]({room:e,room_idx:d,add_room:!1}),b("#modals").html(c),b("#add-room-modal").modal("show"),b("#room-form-name").focus(),b("#add-room-form").submit(this.edit_room),!1},c.prototype.edit_room=function(a){var c,d;return a.preventDefault(),c=b("#add-room-form").serializeObject(),(d=c.room_idx)?(c=JSON.parse(JSON.stringify(c)),c.room_idx&&delete c.room_idx,this.data.rooms[d]=c,this.update(),b("#add-room-modal").modal("hide"),!1):(console.error("room index was missing"),alert("Error"))},c.prototype.set_next_time=function(){var a,c,d,e;if(c=this.data.timeslots.length,!c)return b("#timepicker").timepicker("option","minTime","00:00"),b("#timepicker").timepicker("setTime","09:00");d=this.data.timeslots[c-1].time;try{return e=d.split(":"),a=parseInt(e[0])+1,b("#timepicker").timepicker("setTime",a+":"+e[1])}catch(f){}},c.prototype.add_timeslot_modal=function(){var a;return a=JST["timeslot-modal"](),b("#modals").html(a),b("#timepicker").timepicker({timeFormat:"G:i",show24:!0}),this.set_next_time(),b("#add-timeslot-modal").modal("show"),b("#timepicker").focus(),b("#add-timeslot-form").parsley(),b("#add-timeslot-form").submit(this.add_timeslot),!1},c.prototype.add_timeslot=function(a){var c,d;a.preventDefault(),d=b("#add-timeslot-form").serializeObject(),c=d.time.split(":"),1===c[0].length&&(d.time="0"+d.time),this.data.timeslots.push(d),this.data.timeslots=_.sortBy(this.data.timeslots,"time"),this.update(),b("#add-timeslot-modal").modal("hide")},c.prototype.del_timeslot=function(a){var c;return confirm(b("body").data("i18n-areyousure"))?(c=b(a.currentTarget).data("index"),this.data.timeslots.splice(c,1),this.update()):void 0},c.prototype.add_session_modal=function(a){var c,d,e,f,g;return g=b(a.currentTarget).closest(".sessionslot").data("id"),e=this.data.sessions[g],e||(e={}),e.session_idx=g,c=JST["session-modal"](e),b("#modals").html(c),d=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.whitespace,queryTokenizer:Bloodhound.tokenizers.whitespace,local:this.data.participants.map(function(a){return a.name})}),b("#moderator").tagsinput({tagClass:"btn btn-info btn-xs",typeaheadjs:{source:d.ttAdapter()}}),f=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("value"),queryTokenizer:Bloodhound.tokenizers.whitespace,local:this.data.proposals}),b("#ac-title").typeahead(null,{name:"proposals",display:"value",templates:{suggestion:Handlebars.compile("<div>{{label}}</div>")},source:f.ttAdapter()}).bind("typeahead:select",function(a){return function(c,d){var e,f,g,h,i,j;for(b("#session-description").text(d.description),b("#ac-title").text(d.value),f=d.user_id,i=a.data.participants,j=[],g=0,h=i.length;h>g;g++)e=i[g],e._id===f?(b("#moderator").tagsinput("removeAll"),j.push(b("#moderator").tagsinput("add",e.name))):j.push(void 0);return j}}(this)),b("#edit-session-modal").modal("show"),b("#ac-title").focus(),b("#edit-session-form").submit(this.update_session)},c.prototype.update_session=function(c){var d,e;return c.preventDefault(),d=b("#edit-session-form").serializeObject(),console.log(d),d.session_idx||alert("An error occurred, please reload the page"),e={sid:a(),slug:null,_id:d.session_idx,title:d.title,description:d.description,interested:d.interested,moderator:d.moderator},this.data.sessions[d.session_idx]=e,this.update(),b("#edit-session-modal").modal("hide"),!1},c.prototype.del_session=function(a){var c,d;return confirm(b("body").data("i18n-areyousure"))&&(d=b(a.currentTarget).closest(".sessionslot").data("id"),c=b(a.currentTarget).closest(".sessionslot").attr("id"),delete this.data.sessions[d],this.saveState(),this.render()),!1},c.prototype.init_handlers=function(){var a,c;c=this;try{a=this.data.rooms.toDict("id")}catch(d){a={}}return b("#roomcontainment").sortable({axis:"x",helper:"clone",items:"th",placeholder:"sortable-placeholder",containment:"parent",cancel:".not-sortable",opacity:.5,update:function(c){return function(){var d;return d=[],b("#newsessions #roomcontainment .sorted").each(function(){var c;return c=b(this).data("id"),d.push(a[c])}),c.data.rooms=d,c.update()}}(this)}),b(".sessionslot.enabled").draggable({revert:!0,snap:".sessionslot.enabled",zIndex:1e4}).droppable({hoverClass:"btn btn-info",drop:function(a){return function(c,d){var e,f,g;return g=d.draggable.data("id"),e=b(c.target).data("id"),f=a.data.sessions[e],a.data.sessions[e]=a.data.sessions[g],a.data.sessions[e]._id=e,f?(a.data.sessions[g]=f,f._id=g):delete a.data.sessions[g],a.update()}}(this)}),b("#add-room-modal-button").click(this.add_room_modal),b(".del-room-button").click(this.del_room),b(".edit-room-modal-button").click(this.edit_room_modal),b("#add-timeslot-modal-button").click(this.add_timeslot_modal),b(".del-timeslot-button").click(this.del_timeslot),b(".edit-session-button").click(this.add_session_modal),b(".del-session-button").click(this.del_session)},c}(),b.fn[f]=function(a){return this.each(function(){return b.data(this,"plugin_"+f)?void 0:b.data(this,"plugin_"+f,new c(this,a))})}}(jQuery,window,document),$(function(){return b(),$(".dropdown-toggle").dropdown()})}.call(this);
//# sourceMappingURL=admin.min.map